<!DOCTYPE html>
<html>
<head>
    <title>Chen Zhening's First Map</title>
    <style>
        body{
            background-color: black;
            color: aliceblue;
        }
    </style>
    <style>
        #map {
            width: 100%;
            height: 600px;
            border: 2px solid white;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@9.2.4/dist/ol.css">
</head>
<body>
    <h1>Chen Zhening's First Map</h1>
    <p id="info">Click on the blue mark!</p >
    <div id="map"></div>

    <script src="https://cdn.jsdelivr.net/npm/ol@9.2.4/dist/ol.js"></script>

    <script>
        // 1. 创建地图，使用一个在全球范围内稳定的地图源
        var map = new ol.Map({
            target: 'map',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.XYZ({
                        // 使用一个无需密钥、相对稳定的彩色栅格底图
                        url: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'
                    })
                })
            ],
            view: new ol.View({
                // 将中心点设置为宿舍，并使用 Web Mercator 坐标
                center: ol.proj.fromLonLat([113.0052,28.07513]),
                zoom: 4
            })
        });

        // 2. 创建标记 - 关键修复：使用经纬度坐标，并转换为地图坐标
        var marker = new ol.Feature({
            // 将宿舍的经纬度 [经度, 纬度] 转换为地图坐标
            geometry: new ol.geom.Point(ol.proj.fromLonLat([113.0052,28.07513]))
        });

        // 3. 设置标记样式（蓝底白边）
        marker.setStyle(new ol.style.Style({
            image: new ol.style.RegularShape({
                radius: 10,
                points:6,
                fill: new ol.style.Fill({color: 'blue'}),
                stroke: new ol.style.Stroke({
                    color: 'white',
                    width: 2
                })
            })
        }));

        // 4. 创建矢量图层并添加标记
        var vectorSource = new ol.source.Vector({
            features: [marker]
        });
        var vectorLayer = new ol.layer.Vector({
            source: vectorSource
        });
        map.addLayer(vectorLayer);

        // 5. 添加点击标记的交互
        map.on('click', function(evt) {
            var feature = map.forEachFeatureAtPixel(evt.pixel, function(feature) {
                return feature;
            });

            if (feature) {
                document.getElementById('info').textContent = 'You successfully click on the dorm location of Chen Zhening!';
                console.log("标记被点击！");
            }
        });

        console.log("请点击蓝色六边形标记");
    </script>
</body>
</html>
